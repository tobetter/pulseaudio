From 6a46aba92e3bf840c5fb9640ae0488e94c019322 Mon Sep 17 00:00:00 2001
From: Lennart Poettering <lennart@poettering.net>
Date: Sat, 24 Nov 2007 16:22:23 +0000
Subject: [PATCH] make sure to create ~/.pulse before using any configuration file from it

git-svn-id: svn://svn.0pointer.net/pulseaudio/trunk@2078 fefdeb5f-60dc-0310-8127-8f9354f1896f
---
 src/pulsecore/core-util.c |    9 ++++++++-
 1 files changed, 8 insertions(+), 1 deletions(-)

diff --git a/src/pulsecore/core-util.c b/src/pulsecore/core-util.c
index c1b7f53..03c4a51 100644
--- a/src/pulsecore/core-util.c
+++ b/src/pulsecore/core-util.c
@@ -1129,8 +1129,15 @@ FILE *pa_open_config_file(const char *global, const char *local, const char *env
 
         if ((e = getenv("PULSE_CONFIG_PATH")))
             fn = lfn = pa_sprintf_malloc("%s/%s", e, local);
-        else if (pa_get_home_dir(h, sizeof(h)))
+        else if (pa_get_home_dir(h, sizeof(h))) {
+            char *d;
+
+            d = pa_sprintf_malloc("%s/.pulse", h);
+            mkdir(d, 0755);
+            pa_xfree(d);
+
             fn = lfn = pa_sprintf_malloc("%s/.pulse/%s", h, local);
+        }
 
         if (lfn) {
             FILE *f;
