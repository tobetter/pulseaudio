From cd74480b509332070b785be46df8cb0842d891d6 Mon Sep 17 00:00:00 2001
From: David Henningsson <david.henningsson@canonical.com>
Date: Mon, 5 Sep 2011 13:44:30 +0200
Subject: [PATCH 611/613] Add is_input and is_output to device_port to
 simplify some checks later.

Signed-off-by: David Henningsson <david.henningsson@canonical.com>
---
 src/modules/alsa/alsa-mixer.c |    2 ++
 src/pulsecore/device-port.c   |    2 ++
 src/pulsecore/device-port.h   |    2 ++
 3 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/src/modules/alsa/alsa-mixer.c b/src/modules/alsa/alsa-mixer.c
index 90e1df5..7554b2f 100644
--- a/src/modules/alsa/alsa-mixer.c
+++ b/src/modules/alsa/alsa-mixer.c
@@ -4369,6 +4369,8 @@ static pa_device_port* device_port_alsa_init(pa_hashmap *ports,
             pa_device_port_ref(p);
         }
     }
+    p->is_input |= path->direction == PA_ALSA_DIRECTION_ANY || path->direction == PA_ALSA_DIRECTION_INPUT;
+    p->is_output |= path->direction == PA_ALSA_DIRECTION_ANY || path->direction == PA_ALSA_DIRECTION_OUTPUT;
     if (cp) {
         pa_log_debug("Adding port %s to profile %s", p->name, cp->name);
         pa_hashmap_put(p->profiles, cp->name, cp);
diff --git a/src/pulsecore/device-port.c b/src/pulsecore/device-port.c
index 2651f0b..4aa4ca2 100644
--- a/src/pulsecore/device-port.c
+++ b/src/pulsecore/device-port.c
@@ -65,6 +65,8 @@ pa_device_port *pa_device_port_new(const char *name, const char *description, si
     p->priority = 0;
     p->available = PA_PORT_AVAILABLE_UNKNOWN;
     p->profiles = NULL;
+    p->is_input = FALSE;
+    p->is_output = FALSE;
 
     return p;
 }
diff --git a/src/pulsecore/device-port.h b/src/pulsecore/device-port.h
index cffd2a7..2bcf92f 100644
--- a/src/pulsecore/device-port.h
+++ b/src/pulsecore/device-port.h
@@ -46,6 +46,8 @@ struct pa_device_port {
     pa_port_available_t available;         /**< PA_PORT_AVAILABLE_UNKNOWN, PA_PORT_AVAILABLE_NO or PA_PORT_AVAILABLE_YES \since MERGE_OF_JACK_DETECTION */
 
     pa_hashmap *profiles; /* Can be NULL. Does not own the profiles */
+    pa_bool_t is_input:1;
+    pa_bool_t is_output:1;
     /* .. followed by some implementation specific data */
 };
 
-- 
1.7.5.4

