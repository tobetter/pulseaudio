diff -Nur pulseaudio-0.9.6/src/daemon/caps.c pulseaudio-0.9.6.new/src/daemon/caps.c
--- pulseaudio-0.9.6/src/daemon/caps.c	2007-05-25 20:35:33.000000000 +0000
+++ pulseaudio-0.9.6.new/src/daemon/caps.c	2008-01-24 17:38:01.000000000 +0000
@@ -63,13 +63,16 @@
     pa_log_info("dropping root rights.");
 
 #if defined(HAVE_SETRESUID)
-    setresuid(uid, uid, uid);
+    pa_assert_se(setresuid(uid, uid, uid) >= 0);
 #elif defined(HAVE_SETREUID)
-    setreuid(uid, uid);
+    pa_assert_se(setreuid(uid, uid) >= 0);
 #else
-    setuid(uid);
-    seteuid(uid);
+    pa_assert_se(setuid(uid) >= 0);
+    pa_assert_se(seteuid(uid) >= 0);
 #endif
+
+    pa_assert_se(getuid() == uid);
+    pa_assert_se(geteuid() == uid);
 }
 
 #else
@@ -146,4 +149,3 @@
 }
 
 #endif
-
diff -Nur pulseaudio-0.9.6/src/daemon/caps.h pulseaudio-0.9.6.new/src/daemon/caps.h
--- pulseaudio-0.9.6/src/daemon/caps.h	2007-05-12 23:21:39.000000000 +0000
+++ pulseaudio-0.9.6.new/src/daemon/caps.h	2008-01-24 17:38:01.000000000 +0000
@@ -24,6 +24,19 @@
   USA.
 ***/
 
+/* An assert which guarantees side effects of x */
+#ifdef NDEBUG
+#define pa_assert_se(x)                                                 \
+    do {                                                                \
+        if (!(x)) {                                                     \
+            pa_log_error("%s: Assertion <%s> failed.\n", PA_PRETTY_FUNCTION, #x); \
+            abort();                                                    \
+    }                                                               \
+} while (0)
+#else
+#define pa_assert_se(x) assert(x)
+#endif
+
 void pa_drop_root(void);
 int pa_limit_caps(void);
 int pa_drop_caps(void);
